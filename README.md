# FIFO 서버-클라이언트 애플리케이션

이 프로젝트는 FIFO(named pipe)를 사용하여 서버와 클라이언트 간에 파일 작업 요청을 주고받는 시스템입니다. 서버는 클라이언트로부터 파일 읽기 또는 쓰기 요청을 수신하여 해당 작업을 수행하고, 작업 결과를 클라이언트에 반환합니다.

## 목차
1. [코드 실행 방법](#코드-실행-방법)
2. [간단한 함수 및 코드 설명](#간단한-함수-및-코드-설명)
3. [예외 처리 및 관련 기능 설명](#예외-처리-및-관련-기능-설명)
4. [기타 장점과 단점](#기타-장점과-단점)

---

### 코드 실행 방법

#### 두개의 터미널을 띄우고 실행하였습니다.

1. **서버 컴파일 및 실행** 
    ```bash
    gcc -o server server.c
    ./server
    ```

2. **클라이언트 컴파일 및 실행**
    ```bash
    gcc -o client client.c
    ./client
    ```

3. **프로그램 흐름**
   - 서버가 실행되면 `SERVER_FIFO`를 생성하고 클라이언트의 연결을 대기합니다.
   - 클라이언트가 실행되어 서버에 파일 읽기 또는 쓰기 요청을 보냅니다.
   - 서버는 요청을 수신하여 해당 파일 작업을 수행하고, 작업 결과를 클라이언트에 반환합니다.
   - 클라이언트는 서버로부터 응답을 수신하여 결과를 출력합니다.

---

### 간단한 함수 및 코드 설명

#### 주요 데이터 구조

- **`Request` 구조체**: 클라이언트에서 서버로 전송되는 요청 데이터.
    - `filename`: 작업할 파일 이름.
    - `mode`: 파일 접근 모드(`r` for read, `w` for write).
    - `bytes`: 읽기 또는 쓰기할 바이트 수.
    - `data`: 쓰기 작업의 경우 전송할 데이터.
    - `client_pid`: 클라이언트의 프로세스 ID.

- **`Response` 구조체**: 서버에서 클라이언트로 전송되는 응답 데이터.
    - `status`: 작업 성공(0) 또는 실패(-1) 상태.
    - `data`: 읽기 작업의 경우 파일 내용.
    - `bytes`: 읽거나 쓴 바이트 수.

#### 주요 함수 설명

- **서버 측**
  - `main()`: 서버의 진입점. `SERVER_FIFO`를 생성하고 클라이언트의 요청을 수신하며, 요청이 올 때마다 자식 프로세스를 생성하여 처리합니다.
  - `handle_client_request()`: 클라이언트의 요청을 처리하는 함수로, 파일 작업을 수행하고 클라이언트에 응답을 전송합니다.
  - `process_file_operation()`: 파일 읽기 또는 쓰기 작업을 수행하는 함수입니다.
  - `cleanup()`: 서버 종료 시 `SERVER_FIFO`를 삭제합니다.

- **클라이언트 측**
  - `main()`: 클라이언트의 진입점. 서버와 통신하여 파일 작업 요청을 전송하고 응답을 수신합니다.
  - `get_user_input()`: 사용자로부터 파일 이름, 작업 모드, 바이트 수 또는 데이터를 입력받습니다.
  - `cleanup()`: 클라이언트 종료 시 `client_fifo`를 삭제합니다.

---

### 예외 처리 및 관련 기능 설명

- **FIFO 파일 생성 오류**  
  `SERVER_FIFO`와 `client_fifo`는 각각 서버와 클라이언트에서 생성되며, 기존 파일이 있을 경우 삭제 후 새로 생성됩니다. FIFO 파일 생성이 실패할 경우 프로그램은 종료됩니다.

- **시그널 처리**  
  `SIGINT`, `SIGTERM` 등의 시그널이 발생하면 `handle_signal` 함수가 호출되어 `running` 플래그를 0으로 설정하고 프로그램을 종료하게 합니다. `SIGCHLD` 시그널은 자식 프로세스의 종료를 처리하여 좀비 프로세스를 방지합니다.

- **통신 오류**  
  - 서버가 실행 중이지 않을 때 클라이언트가 연결을 시도하면 `SERVER_FIFO`에 접근할 수 없으며, 클라이언트는 최대 3번까지 재시도한 후 서버가 응답하지 않음을 알립니다.
  - 서버가 `client_fifo`에 응답을 쓰지 못할 경우, 클라이언트의 종료 또는 통신 오류로 간주합니다.

- **파일 작업 오류**  
  - 서버에서 요청한 파일이 존재하지 않거나 접근 권한이 없을 경우, `process_file_operation` 함수는 오류 메시지를 출력하고 오류 코드를 반환합니다. 클라이언트는 해당 작업이 실패했음을 알 수 있습니다.

---

